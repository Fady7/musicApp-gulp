var nowIndex=0,dataList=null,len=0,root=window.player,audio=root.audioManager,indexC=root.Control,indexN=null,timer=null,pro=root.renderPro;function getData(t){$.ajax({url:t,type:"GET",success:function(t){bindTouch(),bindEvent(),dataList=t,root.renderList(t),len=dataList.length,indexN=new indexC(nowIndex,len),pro.renderAllTime(t[0].duration),root.render(t[0]),audio.getAudio(t[0].audio)},error:function(){}})}function bindEvent(){$("body").on("playChange",function(t,o){root.render(dataList[o]),audio.getAudio(dataList[o].audio),"play"==audio.status&&(audio.play(),pro.start(0),rotated(0)),$(".img-box").css({transform:"rotateZ(0deg)",transition:"none"}).attr("data-deg","0"),pro.renderAllTime(dataList[o].duration)}),$(".prev").click(function(){nowIndex=indexN.prev(),pro.upData(0),$("body").trigger("playChange",nowIndex)}),$(".next").click(function(){nowIndex=indexN.next(),pro.upData(0),$("body").trigger("playChange",nowIndex)}),$(".play").click(function(){var t=$(".img-box").attr("data-deg");t=Number(t),"pause"==audio.status?(audio.play(),rotated(t),pro.start()):(audio.pause(),pro.stop(),clearInterval(timer)),$(".play").toggleClass("playing")}),$(".list").on("click",function(){$(this).toggleClass("listShow"),$(".musicList").toggle()}),$(".musicList").on("click","li",function(t){nowIndex=$(this).index(),audio.status="play",$(".play").addClass("playing"),$("body").trigger("playChange",nowIndex)})}function rotated(t){clearInterval(timer),timer=setInterval(function(){$(".img-box").attr("data-deg",t),t+=1,$(".img-box").css({transform:"rotateZ("+t+"deg)",transition:"all 0.2s linear"})},200)}function bindTouch(){var t=$(".pro-bottom").offset(),n=t.left,i=t.width;$(".pro-top .slider").on("touchstart",function(){pro.stop()}).on("touchmove",function(t){var o=(t.changedTouches[0].clientX-n)/i;0<=o&&o<=1&&pro.upData(o)}).on("touchend",function(t){var o=(t.changedTouches[0].clientX-n)/i;if(0<=o&&o<=1){var a=o*dataList[indexN.index].duration;audio.playTo(a),audio.status="play",audio.play(),$(".play").addClass("playing"),pro.start(o)}})}getData("../mock/data.json");